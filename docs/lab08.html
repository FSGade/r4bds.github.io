<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>R for Bio Data Science - Lab 8: Creating a Simple R-package</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./lab09.html" rel="next">
<link href="./lab07.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Lab 8: Creating a Simple R-package</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R for Bio Data Science</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle sidebar-tool" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Welcome to R for Bio Data Science</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prologue.html" class="sidebar-item-text sidebar-link">Prologue</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./getting_started.html" class="sidebar-item-text sidebar-link">Getting Started</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./lab00.html" class="sidebar-item-text sidebar-link">Course Labs</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab01.html" class="sidebar-item-text sidebar-link">Lab 1: Course Intro &amp; the Very Basics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab02.html" class="sidebar-item-text sidebar-link">Lab 2: Data Visualisation I</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab03.html" class="sidebar-item-text sidebar-link">Lab 3: Data Visualisation II</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab04.html" class="sidebar-item-text sidebar-link">Lab 4: Data Wrangling I</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab05.html" class="sidebar-item-text sidebar-link">Lab 5: Data Wrangling II</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab06.html" class="sidebar-item-text sidebar-link">Lab 6: Applying Functional Programming with Purrr to Models</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab07.html" class="sidebar-item-text sidebar-link">Lab 7: Collaborative Bio Data Science using GitHub via RStudio</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab08.html" class="sidebar-item-text sidebar-link active">Lab 8: Creating a Simple R-package</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab09.html" class="sidebar-item-text sidebar-link">Lab 9 Creating a Simple Shiny Application</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab10.html" class="sidebar-item-text sidebar-link">Lab 10 Project Startup &amp; Industry Talks</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./resources.html" class="sidebar-item-text sidebar-link">Resources</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./paths_and_projects.html" class="sidebar-item-text sidebar-link">Paths &amp; Projects</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./variable_assignment_in_r.html" class="sidebar-item-text sidebar-link">Variable Assignment in <code>R</code></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./code_styling.html" class="sidebar-item-text sidebar-link">Code Styling</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./primer_on_linear_models_in_r.html" class="sidebar-item-text sidebar-link">Primer on Linear Models in <code>R</code></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./external_resources.html" class="sidebar-item-text sidebar-link">External Resources</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./course_elements.html" class="sidebar-item-text sidebar-link">Course Elements</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignments.html" class="sidebar-item-text sidebar-link">Assignments</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./project_faq.html" class="sidebar-item-text sidebar-link">Project FAQ</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exam.html" class="sidebar-item-text sidebar-link">Exam</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#packages" id="toc-packages" class="nav-link active" data-scroll-target="#packages">Package(s)</a></li>
  <li><a href="#schedule" id="toc-schedule" class="nav-link" data-scroll-target="#schedule">Schedule</a></li>
  <li><a href="#learning-materials" id="toc-learning-materials" class="nav-link" data-scroll-target="#learning-materials">Learning Materials</a></li>
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link" data-scroll-target="#learning-objectives">Learning Objectives</a></li>
  <li><a href="#sec-exercises" id="toc-sec-exercises" class="nav-link" data-scroll-target="#sec-exercises">Exercises</a>
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#how-to-work-with-an-r-package" id="toc-how-to-work-with-an-r-package" class="nav-link" data-scroll-target="#how-to-work-with-an-r-package">How to work with an R package</a></li>
  <li><a href="#tasks" id="toc-tasks" class="nav-link" data-scroll-target="#tasks">TASKS</a></li>
  <li><a href="#group-assignment" id="toc-group-assignment" class="nav-link" data-scroll-target="#group-assignment"><span style="color: red;">GROUP ASSIGNMENT</span></a></li>
  <li><a href="#last-tip-on-packages" id="toc-last-tip-on-packages" class="nav-link" data-scroll-target="#last-tip-on-packages">Last tip on packages</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Lab 8: Creating a Simple R-package</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="stop-section-not-yet-completed" class="level4">
<h4 class="anchored" data-anchor-id="stop-section-not-yet-completed">STOP: Section not yet completed!</h4>
</section>
<section id="packages" class="level2">
<h2 class="anchored" data-anchor-id="packages">Package(s)</h2>
<ul>
<li><a href="https://github.com/r-lib/devtools">devtools</a></li>
<li><a href="https://devtools.r-lib.org">usethis</a></li>
<li><a href="https://roxygen2.r-lib.org">roxygen2</a></li>
<li><a href="https://testthat.r-lib.org">testthat</a></li>
</ul>
</section>
<section id="schedule" class="level2">
<h2 class="anchored" data-anchor-id="schedule">Schedule</h2>
<ul>
<li>08.00 - 08.15: Recap of exercises from last lab</li>
<li>08.15 - 08.30: Assignment walk-through</li>
<li>08.30 - 09.00: <a href="https://raw.githack.com/r4bds/r4bds.github.io/main/lecture_lab08.html">Lecture</a></li>
<li>09.00 - 09.15: Break</li>
<li>09.00 - 12.00: <a href="#sec-exercises">Exercises</a></li>
</ul>
</section>
<section id="learning-materials" class="level2">
<h2 class="anchored" data-anchor-id="learning-materials">Learning Materials</h2>
<p><em>Please prepare the following materials:</em></p>
<ul>
<li>Cheatsheet: <a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/package-development.pdf">Package development with devtools</a> – When in doubt, check here first</li>
<li>Web: <a href="https://www.datacamp.com/community/tutorials/r-packages-guide">R Packages: A Beginner’s Tutorial</a> – Read this before class</li>
<li>Web: <a href="https://support.rstudio.com/hc/en-us/articles/200486488-Developing-Packages-with-RStudio">Developing Packages with RStudio</a> – Creating an R Package with RStudio</li>
<li>Web: <a href="https://kbroman.org/pkg_primer/">R package primer a minimal tutorial</a> – Brief but comprehensive R Package tutorial</li>
<li>Book: <a href="https://r-pkgs.org/intro.html">R Packages - 1 Introduction</a> – Everything you need to know about R Packages</li>
</ul>
</section>
<section id="learning-objectives" class="level2">
<h2 class="anchored" data-anchor-id="learning-objectives">Learning Objectives</h2>
<p><em>A student who has met the objectives of the session will be able to:</em></p>
<ul>
<li>Prepare a simple R package for distributing documented functions</li>
<li>Explain the terms Repository, Dependencies, and Namespace</li>
<li>Implement testing in an R package</li>
<li>Collaboratively work on an R package on GitHub</li>
</ul>
</section>
<section id="sec-exercises" class="level2">
<h2 class="anchored" data-anchor-id="sec-exercises">Exercises</h2>
<p><em>Read the steps of this exercises carefully while completing them</em></p>
<section id="introduction" class="level3">
<h3 class="anchored" data-anchor-id="introduction">Introduction</h3>
<p>The aim of these exercises is to set up a collaborative coding project using GitHub and collaborate on creating a simple R package that replicates the central dogma of molecular biology.</p>
<p>The exercises uses what you learned in <a href="https://raw.githack.com/r4bds/r4bds.github.io/main/docs/lab07.html">Lab 7</a> and its <a href="https://raw.githack.com/r4bds/r4bds.github.io/main/docs/lab07.html#sec-exercises">exercises</a>. But don’t worry too much, the setup steps will be given here as well.</p>
<hr>
</section>
<section id="how-to-work-with-an-r-package" class="level3">
<h3 class="anchored" data-anchor-id="how-to-work-with-an-r-package">How to work with an R package</h3>
<p>There are a few things to know when creating a package before you jump in. These are not strict rules, but they make your life easier when bug-fixing and make the package much easier to use for the users. To learn about those, click the foldout sections in the following topics. If you feel confident in the realm of R packages, feel free to skip ahead, but don’t leave your group too far behind.</p>
<section id="dependencies" class="level4">
<h4 class="anchored" data-anchor-id="dependencies">Dependencies</h4>
<details>
<summary>
The one strict rule is <b>Never use library(“package”) within a package! </b>
</summary>
<p>Instead, add the packages your are going to use to the <code>DESCRIPTION</code> file and in the function descriptions. This is done by running <code>usethis::use_package("packageName")</code> in the console and adding <code>@import package</code> (OK) or <code>@importFrom package function1 function2 ...</code> (Best). Using the functions in your package is then done with <code>package::function()</code> (e.g., <code>dplyr::mutate()</code>) or omitting the <code>package::</code>.</p>
<p>This way, it is easy to read what functions are from your package, and your package namespace does not get cluttered. Read more in the Namespace section.</p>
It should also be a goal to make your package depend on as few other packages as possible. The user will need to install all packages your package depends on, but then also every package those depends on - that list quickly become quite long if you are not careful.
</details>
</section>
<section id="functions" class="level4">
<h4 class="anchored" data-anchor-id="functions">Functions</h4>
<details>
<summary>
A package is typically a collections of functions.
</summary>
<p>These functions are stored in <code>.R</code> files in the R folder. A good starting point is to create an <code>.R</code> file for each function. But, as the package becomes bigger, it often makes sense to combine related functions into bigger files.</p>
You can quickly create a new <code>.R</code> file with <code>usethis::use_r("function_name")</code>. Or do it manually, as you are used to.
</details>
</section>
<section id="documenting-functions" class="level4">
<h4 class="anchored" data-anchor-id="documenting-functions">Documenting functions</h4>
Try running <code>?mean</code> in the Console.
<details>
<summary>
If you have every wondered how to write a manual like the one that pops up, please click here and read - if not, consider reading it anyway, as you will use it later.
</summary>
<p>When you have made a function, or have at least defined one, you should describe what it does and how to use it. The manual you write for your function is the function documentation, and it should describe the purpose of the function and how to use it.</p>
<p>You can read extensively about it <a href="https://r-pkgs.org/man.html">here</a>, but I will give you the most essential information to get you started.</p>
<p>The R package <code>roxygen2</code> makes this easy as 1-2-3. It is part of <code>devtools</code> and is already installed. It uses <code>#'</code> comments above the function. <code>@</code> tags lets you add specific details to the function documentation.</p>
<p>Create an roxygen skeleton by clicking somewhere in your function. Go to the ‘Code’ tab in the top of your window and select ‘Insert Roxygen Skeleton’.</p>
<p>This will look something like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Title</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param foo </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param bar </span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#' @return</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#' @export</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#'</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#' @examples</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>myFunction <span class="ot">&lt;-</span> <span class="cf">function</span>(foo, bar){</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Do stuff with foo and bar</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  foobar <span class="ot">&lt;-</span> (foo <span class="sc">*</span> bar) <span class="sc">/</span> (foo <span class="sc">+</span> bar)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(foobar)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This allows you to add the most basic descriptions. To begin with, the Title, <code>@param</code>, and <code>@export</code> are the most important, you may remove the other tags for now. A more detailed example is given <a href="https://r-pkgs.org/man.html#man-functions">here</a>. There, you can also read about documenting datasets and other object types - even the package itself.</p>
</details>
</section>
<section id="namespace" class="level4">
<h4 class="anchored" data-anchor-id="namespace">Namespace</h4>
<details>
<summary>
Your package namespace can quickly become very cluttered, if you are not careful.
</summary>
<p>Therefore, follow these rules:</p>
<ul>
<li>Only <code>@export</code> the functions the users will use. Removing the tag makes the function internal and hides it from your package namespace. It can still be freely used within your package and accessed outside your package with <code>package:::internal_function()</code></li>
<li>Make your code explicit with <code>package::function()</code>.
<ul>
<li>This step is not mandatory, but makes reading the code easier.</li>
</ul></li>
<li>Add your dependencies in the DESCRIPTION file with <code>usethis::use_package("packageName")</code></li>
<li>Only very rarely use the <code>@import</code> tag. Aim to use the <code>@importFrom</code> tags in your function descriptions instead.</li>
</ul>
<p>You can read more extensively about namespace <a href="https://r-pkgs.org/namespace.html">here</a>.</p>
</details>
</section>
<section id="testing" class="level4">
<h4 class="anchored" data-anchor-id="testing">Testing</h4>
<details>
<summary>
Testing is essential
</summary>
<p>to ensure your package runs smoothly and that no bugs are introduced when you make a seemingly minor change. It is handled with the <code>testthat</code> package, which is also installed with <code>devtools</code>.</p>
<p>I will not go into too much detail here, but know that testing is an important, but often neglected, part of building a package. You can read more about it <a href="https://r-pkgs.org/tests.html#tests">here</a>.</p>
<p>Every time you run the <code>usethis::use_r()</code> function to create a new script, the function encourages you to create a test alongside the new function. I recommend you follow that advise.</p>
<p>You create a test by running <code>usethis::use_test("function name")</code>.</p>
<p>The function creates a new folder <code>tests</code> and creates a test script for the function. The good R package creator writes a few tests for every function.</p>
<p>The exercises will ask you to make a simple test for every function, introducing you to the concept.</p>
</details>
</section>
<section id="pkgwf" class="level4">
<h4 class="anchored" data-anchor-id="pkgwf">The Package Workflow</h4>
When creating a package, it is important to test your work along the way.
<details>
<summary>
You can do that in many ways, but I recommend the following workflow:
</summary>
<ol type="1">
<li>Write a function / make a change
<ul>
<li>If it is a new function, document it</li>
</ul></li>
<li>Save your files: <code>rstudioapi::documentSaveAll()</code></li>
<li>Create package documentation: <code>devtools::document()</code></li>
<li>Load package: <code>devtools::load_all()</code></li>
<li>Your package is now loaded, and you can test that it works as intended.</li>
</ol>
<p>Optionally, you can save the three lines of code in <code>dev/load.R</code> and run the lines with <code>source("dev/load.R")</code>. If you do, add the <code>dev</code> folder to the <code>.Rbuildignore</code> file.</p>
</details>
<hr>
</section>
</section>
<section id="tasks" class="level3">
<h3 class="anchored" data-anchor-id="tasks">TASKS</h3>
<p><em>Now you know the basics of creating a package. And you are ready to begin.</em></p>
<section id="task-1---setting-up-the-r-package" class="level4">
<h4 class="anchored" data-anchor-id="task-1---setting-up-the-r-package">Task 1 - Setting up the R package</h4>
<p>In the first task, <strong>one team member</strong> (you decide who) will initiate a package project and push it to Github. Then, when instructed, the <strong>remaining group members</strong> will connect to that repository, and the real package building will begin.</p>
<section id="task-1.1---create-r-package" class="level5">
<h5 class="anchored" data-anchor-id="task-1.1---create-r-package">Task 1.1 - Create R Package</h5>
<ol type="1">
<li>Go to <a href="https://teaching.healthtech.dtu.dk/22100/rstudio.php">R for Bio Data Science RStudio Cloud Server</a> and login.</li>
<li>Click <code>Create a project</code><img src="images/L08_create.png" class="img-fluid" style="width:5.0%"> in the top left and choose <code>New Directory</code>.</li>
<li>Select <code>R Package</code> and pick a fitting Package name.
<ul>
<li>The package you will create will replicate the central dogma of molecular biology. Let that inspire you</li>
<li>Look up naming rules <a href="https://r-pkgs.org/workflows101.html#naming">here</a></li>
<li>The most important rule: <code>_</code>, <code>-</code>, and <code>'</code> are not allowed.</li>
</ul></li>
<li>Click “Create project”.</li>
</ol>
<p>RStudio will now create an R project for you that contains all necessary files and folders.</p>
<ol start="5" type="1">
<li>Open the <code>DESCRIPTION</code> file and write a title for your package, a small description, and add authors.</li>
</ol>
<ul>
<li>When adding authors, the format is:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Author<span class="sc">@</span>R<span class="sc">:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fu">person</span>(<span class="at">given =</span> <span class="st">"firstname"</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">family =</span> <span class="st">"lastname"</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">role =</span> <span class="fu">c</span>(<span class="st">"aut"</span>, <span class="st">"cre"</span>), <span class="co"># There must be a "cre", but there can only be one</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">email =</span> <span class="st">"your@email.com"</span>), </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">person</span>(<span class="at">given =</span> <span class="st">"firstname"</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">family =</span> <span class="st">"lastname"</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">role =</span> <span class="st">"aut"</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">email =</span> <span class="st">"your@email.com"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="6" type="1">
<li>Create an MIT license <code>usethis::use_mit_license("Group name")</code></li>
<li><details>
<summary>
<strong>Optional</strong> setup steps (generally good, but not essential for this course)
</summary>
<ul>
<li>
<em>If the “Git” tab is not in the lower left panel</em>:
</li>
<ul>
<li>
Run <code>usethis::use_git()</code> and reopen the project to have it appear
</li>
<li>
To use GitHub, you create an empty repository there and link the account with <code>gert::git_remote_add("link")</code> and <code>gert::git_push("origin")</code>
</li>
<li>
<code>git push</code> will now push your committed changes to the GitHub repository
</li>
</ul>
<li>
Add a lifecycle badge: <code>usethis::use_lifecycle_badge( "Experimental" )</code>
</li>
<li>
Write vignettes: <code>usethis::use_vignette("Vignette name")</code>
</li>
<li>
Add a Readme file <code>usethis::use_readme_rmd( open = FALSE )</code>. You will do that in the Group Assignment later
</li>
</ul>
</details></li>
</ol>
</section>
<section id="task-1.2---setup-github-repository-for-your-groups-r-package" class="level5">
<h5 class="anchored" data-anchor-id="task-1.2---setup-github-repository-for-your-groups-r-package">Task 1.2 - Setup GitHub Repository for your group’s R package</h5>
<p><strong>Still only the first team member</strong></p>
<ol type="1">
<li>Go to <a href="https://github.com/rforbiodatascience22">https://github.com/rforbiodatascience22</a></li>
<li>Click the green <code>New</code>-button</li>
<li>Create a new repository called <code>group_X_package</code>. Remember to replace the <strong>X</strong></li>
<li>Select <code>rforbiodatascience22</code> as owner</li>
<li>Make the repository <code>Public</code></li>
<li>Click the green <code>Create repository</code>-button</li>
<li>In this new repository, click the <code>settings</code> tab</li>
<li>Click <code>Collaborators and Team</code></li>
<li>Click the green <code>Add people</code>-button</li>
<li>Invite the remaining group members</li>
<li>All other team members should now have access to the repository, <strong>but do not create your own project yet.</strong></li>
</ol>
</section>
<section id="task-1.3---connect-your-rstudio-server-project-to-the-github-repository" class="level5">
<h5 class="anchored" data-anchor-id="task-1.3---connect-your-rstudio-server-project-to-the-github-repository">Task 1.3 - Connect your RStudio Server Project to the GitHub Repository</h5>
<p><strong>Still only the first team member</strong></p>
<ol type="1">
<li>Find your <code>PAT</code> key or create a new
<details>
<summary>
How to create a new one
</summary>
<ul>
<li>
Type in the console <code>usethis::create_github_token()</code>. You’re going to be redirected to GitHub website.
</li><li>
In case you did that step manually, remember to give permission to access your repositories.
</li><li>
You need to type your password. Don’t change the default settings of creating the token except for the description – set ‘RStudio Cloud’ or something similar. Then hit Generate token.
</li><li>
Copy the generated token (should start with ghp_) and store it securely (e.g., in a password manager). Do not keep it in a plain file.
</li></ul>
</details></li>
<li>Go back to the RStudio Server project</li>
<li>Type in the console <code>gitcreds::gitcreds_set()</code> and paste the <code>PAT</code> key</li>
<li>Stage all files (in the <code>git</code> window in the top right) by ticking all boxes under <code>Staged</code></li>
<li>Still in the console, run the following commands. Replace your group number and use your GitHub username and email. You run these to link your project to the GitHub repository you created. Remember to replace the <strong>X</strong>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>usethis<span class="sc">::</span><span class="fu">use_git_remote</span>(<span class="at">name =</span> <span class="st">"origin"</span>, <span class="st">"https://github.com/rforbiodatascience22/group_X_package.git"</span>, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>usethis<span class="sc">::</span><span class="fu">use_git_config</span>(<span class="at">user.name =</span> <span class="st">"USERNAME"</span>, <span class="at">user.email =</span> <span class="st">"USEREMAIL@EXAMPLE.ORG"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>gert<span class="sc">::</span><span class="fu">git_commit_all</span>(<span class="st">"Package setup"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>gert<span class="sc">::</span><span class="fu">git_push</span>(<span class="st">"origin"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>All other team members</strong></p>
<p><em>After your teammate has pushed to GitHub.</em></p>
<ol type="1">
<li>In the RStudio Server, create a new project based on the GitHub Repository just created by your teammate.
<ul>
<li>Click <code>Create a project</code><img src="images/L08_create.png" class="img-fluid" style="width:5.0%"> in the top left.</li>
<li>Choose <code>Version Control</code> and then <code>Git</code>.</li>
<li>Paste in the repository URL: <code>"https://github.com/rforbiodatascience22/group_X_package.git"</code>. Remember to replace the <strong>X</strong>.</li>
<li>Give the directory a fitting name and click <code>Create Project</code>.</li>
</ul></li>
<li>Find your <code>PAT</code> key or create a new
<details>
<summary>
How to create a new one
</summary>
<ul>
<li>
Type in the console <code>usethis::create_github_token()</code>. You’re going to be redirected to GitHub website.
</li><li>
In case you did it manually, remember to give permission to access your repositories.
</li><li>
You need to type your password. Don’t change the default settings of creating the token except for the description – set ‘RStudio Cloud’ or something similar. Then hit Generate token.
</li><li>
Copy the generated token (should start with ghp_) and store it securely (e.g.&nbsp;in password manager). Do not keep it in a plain file.
</li></ul>
</details></li>
<li>Go back to the RStudio Server project</li>
<li>Type in the console <code>gitcreds::gitcreds_set()</code> and paste the <code>PAT</code> key</li>
<li>Still in the console, run the following commands. Replace your GitHub username and email.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>usethis<span class="sc">::</span><span class="fu">use_git_config</span>(<span class="at">user.name =</span> <span class="st">"USERNAME"</span>, <span class="at">user.email =</span> <span class="st">"USEREMAIL@EXAMPLE.ORG"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>If RStudio at any point asks you to log in to GitHub, redo step 4 and 5.</strong></p>
<p>Now you are ready to work on the R package.</p>
</section>
</section>
<section id="task-2---build-the-package" class="level4">
<h4 class="anchored" data-anchor-id="task-2---build-the-package">Task 2 - Build the package</h4>
<hr>
<p>Each team member should build and implement their own function. The code will be given, but you will be asked to come up with a name for your function and many of the variables, so discuss in the team what naming convention you want to use. Do you want to use <code>snake_case</code> (common in tidyverse) or <code>camelCase</code> (common in Bioconductor)? It doesn’t really matter, but try to be consistent.</p>
<p><br></p>
<section id="task-2.1---incorporate-data" class="level5">
<h5 class="anchored" data-anchor-id="task-2.1---incorporate-data">Task 2.1 - Incorporate data</h5>
<p>In this task you will include the following codon table in your package.</p>
<p><strong>This task should be done by one team member</strong>. The rest should follow along.</p>
<ol type="1">
<li>Below is a standard codon table. Store it in an object with a name of your own choosing.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">"UUU"</span> <span class="ot">=</span> <span class="st">"F"</span>, <span class="st">"UCU"</span> <span class="ot">=</span> <span class="st">"S"</span>, <span class="st">"UAU"</span> <span class="ot">=</span> <span class="st">"Y"</span>, <span class="st">"UGU"</span> <span class="ot">=</span> <span class="st">"C"</span>,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"UUC"</span> <span class="ot">=</span> <span class="st">"F"</span>, <span class="st">"UCC"</span> <span class="ot">=</span> <span class="st">"S"</span>, <span class="st">"UAC"</span> <span class="ot">=</span> <span class="st">"Y"</span>, <span class="st">"UGC"</span> <span class="ot">=</span> <span class="st">"C"</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"UUA"</span> <span class="ot">=</span> <span class="st">"L"</span>, <span class="st">"UCA"</span> <span class="ot">=</span> <span class="st">"S"</span>, <span class="st">"UAA"</span> <span class="ot">=</span> <span class="st">"_"</span>, <span class="st">"UGA"</span> <span class="ot">=</span> <span class="st">"_"</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"UUG"</span> <span class="ot">=</span> <span class="st">"L"</span>, <span class="st">"UCG"</span> <span class="ot">=</span> <span class="st">"S"</span>, <span class="st">"UAG"</span> <span class="ot">=</span> <span class="st">"_"</span>, <span class="st">"UGG"</span> <span class="ot">=</span> <span class="st">"W"</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"CUU"</span> <span class="ot">=</span> <span class="st">"L"</span>, <span class="st">"CCU"</span> <span class="ot">=</span> <span class="st">"P"</span>, <span class="st">"CAU"</span> <span class="ot">=</span> <span class="st">"H"</span>, <span class="st">"CGU"</span> <span class="ot">=</span> <span class="st">"R"</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"CUC"</span> <span class="ot">=</span> <span class="st">"L"</span>, <span class="st">"CCC"</span> <span class="ot">=</span> <span class="st">"P"</span>, <span class="st">"CAC"</span> <span class="ot">=</span> <span class="st">"H"</span>, <span class="st">"CGC"</span> <span class="ot">=</span> <span class="st">"R"</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"CUA"</span> <span class="ot">=</span> <span class="st">"L"</span>, <span class="st">"CCA"</span> <span class="ot">=</span> <span class="st">"P"</span>, <span class="st">"CAA"</span> <span class="ot">=</span> <span class="st">"Q"</span>, <span class="st">"CGA"</span> <span class="ot">=</span> <span class="st">"R"</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"CUG"</span> <span class="ot">=</span> <span class="st">"L"</span>, <span class="st">"CCG"</span> <span class="ot">=</span> <span class="st">"P"</span>, <span class="st">"CAG"</span> <span class="ot">=</span> <span class="st">"Q"</span>, <span class="st">"CGG"</span> <span class="ot">=</span> <span class="st">"R"</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"AUU"</span> <span class="ot">=</span> <span class="st">"I"</span>, <span class="st">"ACU"</span> <span class="ot">=</span> <span class="st">"T"</span>, <span class="st">"AAU"</span> <span class="ot">=</span> <span class="st">"N"</span>, <span class="st">"AGU"</span> <span class="ot">=</span> <span class="st">"S"</span>,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"AUC"</span> <span class="ot">=</span> <span class="st">"I"</span>, <span class="st">"ACC"</span> <span class="ot">=</span> <span class="st">"T"</span>, <span class="st">"AAC"</span> <span class="ot">=</span> <span class="st">"N"</span>, <span class="st">"AGC"</span> <span class="ot">=</span> <span class="st">"S"</span>,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"AUA"</span> <span class="ot">=</span> <span class="st">"I"</span>, <span class="st">"ACA"</span> <span class="ot">=</span> <span class="st">"T"</span>, <span class="st">"AAA"</span> <span class="ot">=</span> <span class="st">"K"</span>, <span class="st">"AGA"</span> <span class="ot">=</span> <span class="st">"R"</span>,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"AUG"</span> <span class="ot">=</span> <span class="st">"M"</span>, <span class="st">"ACG"</span> <span class="ot">=</span> <span class="st">"T"</span>, <span class="st">"AAG"</span> <span class="ot">=</span> <span class="st">"K"</span>, <span class="st">"AGG"</span> <span class="ot">=</span> <span class="st">"R"</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"GUU"</span> <span class="ot">=</span> <span class="st">"V"</span>, <span class="st">"GCU"</span> <span class="ot">=</span> <span class="st">"A"</span>, <span class="st">"GAU"</span> <span class="ot">=</span> <span class="st">"D"</span>, <span class="st">"GGU"</span> <span class="ot">=</span> <span class="st">"G"</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"GUC"</span> <span class="ot">=</span> <span class="st">"V"</span>, <span class="st">"GCC"</span> <span class="ot">=</span> <span class="st">"A"</span>, <span class="st">"GAC"</span> <span class="ot">=</span> <span class="st">"D"</span>, <span class="st">"GGC"</span> <span class="ot">=</span> <span class="st">"G"</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"GUA"</span> <span class="ot">=</span> <span class="st">"V"</span>, <span class="st">"GCA"</span> <span class="ot">=</span> <span class="st">"A"</span>, <span class="st">"GAA"</span> <span class="ot">=</span> <span class="st">"E"</span>, <span class="st">"GGA"</span> <span class="ot">=</span> <span class="st">"G"</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"GUG"</span> <span class="ot">=</span> <span class="st">"V"</span>, <span class="st">"GCG"</span> <span class="ot">=</span> <span class="st">"A"</span>, <span class="st">"GAG"</span> <span class="ot">=</span> <span class="st">"E"</span>, <span class="st">"GGG"</span> <span class="ot">=</span> <span class="st">"G"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Run <code>usethis::use_data(name_of_object, overwrite = TRUE, internal = TRUE)</code></li>
<li>You have now made the data available to our functions, but we also want to make it visible for our users.
<ul>
<li>Run <code>usethis::use_data(name_of_object, overwrite = TRUE)</code>.</li>
</ul></li>
<li>Write a data manual (document the data).
<ul>
<li>All non-internal data should be documented in a <code>data.R</code> file in the <code>R</code> folder. Create it with <code>usethis::use_r("data")</code></li>
<li>Add the following scaffold and write a <em>very</em> brief description of the data (see an example <a href="https://r-pkgs.org/data.html#documenting-data">here</a>). Don’t spend a lot of time here.</li>
</ul></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Title</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' Description</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#' @source \url{https://www.ncbi.nlm.nih.gov/Taxonomy/Utils/wprintgc.cgi?chapter=tgencodes#SG1}</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="st">"name_of_object"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Normally, you should also describe how the raw data was cleaned. You would do that in the file that opens after running <code>usethis::use_data_raw( name = "name_of_object", open = TRUE )</code>, but that is less relevant here, so we will skip that part.</p>
<p>Your package now includes some data.</p>
<p>Restart R, clean your Environment (small broom in the Environment tab), run the three lines of code from <a href="#pkgwf">The Package Workflow</a> section, and run <code>?name_of_object</code>. Your manual should pop up. Try printing the object as well to see what it looks like <code>print(name_of_object)</code>.</p>
<p>Push your changes to GitHub. <strong>The other team members</strong> pull the changes to have the data available to you as well.</p>
<p><br></p>
</section>
<section id="task-2.2---implement-functions" class="level5">
<h5 class="anchored" data-anchor-id="task-2.2---implement-functions">Task 2.2 - Implement functions</h5>
<p>In this task you will be working individually to implement a function each. If you are fewer in the team than the number of functions. The quickest to finish can implement the remaining, or separate them out as you see fit.</p>
<p>If you want an additional challenge, each team member can create their own Git branch <code>gert::git_branch_checkout("branch_name")</code> and work there. When done, merge your branch with the main branch. That is a more clean and ‘proper’ workflow, but completely optional.</p>
<p>If you are in doubt what the underlying functions do, run <code>?function_name</code> to get a hint about their purpose. Also, remember the functions are replicating the central dogma. Let that inspire you, when naming the functions and variables. If you get stuck, ask your teammates about their functions.</p>
<p>Function five is a bit more involved. Do it together or help your teammate out if it causes problems.</p>
<p>For each function, complete the following steps:</p>
<ol type="1">
<li>Look carefully at your function. Choose a fitting name for it</li>
<li>Run <code>usethis::use_r("function_name")</code> to create an <code>.R</code> file for the function</li>
<li>Paste in the function and rename all places it says <code>name_me</code> with fitting names</li>
<li>Click somewhere in the function. In the toolbar at the very top of the page, choose <code>Code</code> and click <code>Insert Roxygen Skeleton</code></li>
<li>Fill out the function documentation
<ul>
<li>Give the function a title</li>
<li>Do not write anything after <code>@export</code></li>
<li>The parameters should have the format: <code>@param param_name description of parameter</code></li>
<li>The return has the format: <code>@return description of function output</code></li>
<li>Examples can span multiple lines and what you write will be run.</li>
<li><strong>Important!</strong> Either fill out everything or delete what you don’t describe. Otherwise, the package check will fail (Do <strong>not</strong> delete <code>@export</code> for these functions).</li>
</ul></li>
<li>Run the three lines of codes from <a href="#pkgwf">The Package Workflow</a> section</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>rstudioapi<span class="sc">::</span><span class="fu">documentSaveAll</span>()  <span class="co"># Saves all you files</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">document</span>()  <span class="co"># Writes all your manuals for you</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">load_all</span>()  <span class="co"># Simulates library("your package"), allowing you to use your functions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="7" type="1">
<li>View your function documentation with <code>?function_name</code></li>
<li>Defining a test or a series of tests around your newly created function ensures future corrections will not yield undesired results. Create such a test for your function. Run <code>usethis::use_test("function_name")</code> and write a test. Draw some inspiration from <a href="https://r-pkgs.org/tests.html#test-structure">here</a> or from running <code>?testthat::expect_equal</code>.
<ul>
<li><strong>Skip this step for function five</strong>. Instead, write inline code comments for each chunk of code. Press <code>Cmd+Shift+c</code> / <code>Ctrl+Shift+C</code> to comment your currently selected line.</li>
</ul></li>
<li>Rerun the three lines from The Package Workflow section and check that the package works with <code>devtools::check()</code>
<ul>
<li><details>
<summary>
Briefly about check
</summary>
<code>devtools::check()</code> will check every aspect of your package and run the tests you created. You will likely get some warnings or notes like ‘No visible binding for global variables’. They are often harmless, but, if you like, you can get rid of them as described <a href="https://www.r-bloggers.com/2019/08/no-visible-binding-for-global-variable/">here</a>. The check will tell you what might cause problems with your package and often also how to fix it. If there are any errors, fix those. Warnings and notes are also good to address. Feel free to do that if any pops up.
</details></li>
</ul></li>
<li>If it succeeds without errors, push your changes to GitHub
<ul>
<li>Use the RStudio GUI if you prefer</li>
<li>Remember to pull first</li>
<li>If you chose to create your own branch, <a href="https://www.w3schools.com/git/git_branch_merge.asp">merge it with master/main</a>.</li>
</ul></li>
</ol>
<details>
<summary>
Function one
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>name_me1 <span class="ot">&lt;-</span> <span class="cf">function</span>(name_me2){</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  name_me3 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>, <span class="st">"C"</span>), <span class="at">size =</span> name_me2, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  name_me4 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(name_me3, <span class="at">collapse =</span> <span class="st">""</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(name_me4)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<details>
<summary>
Function two
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>name_me1 <span class="ot">&lt;-</span> <span class="cf">function</span>(name_me2){</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  name_me3 <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"T"</span>, <span class="st">"U"</span>, name_me2)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(name_me3)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<details>
<summary>
Function three
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>name_me1 <span class="ot">&lt;-</span> <span class="cf">function</span>(name_me2, <span class="at">start =</span> <span class="dv">1</span>){</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  name_me3 <span class="ot">&lt;-</span> <span class="fu">nchar</span>(name_me2)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  codons <span class="ot">&lt;-</span> <span class="fu">substring</span>(name_me2,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">first =</span> <span class="fu">seq</span>(<span class="at">from =</span> start, <span class="at">to =</span> name_me3<span class="dv">-3</span><span class="sc">+</span><span class="dv">1</span>, <span class="at">by =</span> <span class="dv">3</span>),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">last =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">3</span><span class="sc">+</span>start<span class="dv">-1</span>, <span class="at">to =</span> name_me3, <span class="at">by =</span> <span class="dv">3</span>))</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(codons)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<details>
<summary>
Function four
</summary>
<p><code>name_of_your_object</code> refers to the codon table you stored in Task 2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>name_me <span class="ot">&lt;-</span> <span class="cf">function</span>(codons){</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  name_me2 <span class="ot">&lt;-</span> <span class="fu">paste0</span>(name_of_your_object[codons], <span class="at">collapse =</span> <span class="st">""</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(name_me2)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<details>
<summary>
Function five
</summary>
<p>This function will be the first to use dependencies. As a reminder, a dependency is a package that your package depends on. In this case, it will be <code>magrittr</code>, <code>stringr</code>, and <code>ggplot2</code>. They are already installed, so you don’t need to do that. The best way to add these packages to your own is to first add them to your package dependencies with <code>usethis::use_package("package_name")</code>. Do that with all three.</p>
<p>For <code>magrittr</code> it is a good idea to add the Tidyverse pipe <code>%&gt;%</code> to your package namespace. When writing your function documentation, add a line with <code>@importFrom magrittr %&gt;%</code>. For the <code>ggplot2</code> functions, we will use <code>ggplot2::function_name</code> everywhere a <code>ggplot2</code> function is used. Also add <code>@import ggplot2</code> to the function description. The same applies for <code>stringr</code>, but since we only use a few functions, add <code>@importFrom stringr str_split boundary str_count</code> to the function description.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>name_me1 <span class="ot">&lt;-</span> <span class="cf">function</span>(name_me2){</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  name_me3 <span class="ot">&lt;-</span> name_me2 <span class="sc">|&gt;</span>  </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    stringr<span class="sc">::</span><span class="fu">str_split</span>(<span class="at">pattern =</span> stringr<span class="sc">::</span><span class="fu">boundary</span>(<span class="st">"character"</span>), <span class="at">simplify =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.character</span>() <span class="sc">|&gt;</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unique</span>()</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  counts <span class="ot">&lt;-</span> <span class="fu">sapply</span>(name_me3, <span class="cf">function</span>(amino_acid) stringr<span class="sc">::</span><span class="fu">str_count</span>(<span class="at">string =</span> name_me2, <span class="at">pattern =</span>  amino_acid)) <span class="sc">|&gt;</span>  </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>()</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(counts) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Counts"</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  counts[[<span class="st">"Name_me2"</span>]] <span class="ot">&lt;-</span> <span class="fu">rownames</span>(counts)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  name_me4 <span class="ot">&lt;-</span> counts <span class="sc">|&gt;</span>  </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> Name_me2, <span class="at">y =</span> Counts, <span class="at">fill =</span> Name_me2)) <span class="sc">+</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(name_me4)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<p><br></p>
</section>
</section>
<section id="task-3---group-discussion" class="level4">
<h4 class="anchored" data-anchor-id="task-3---group-discussion">Task 3 - Group discussion</h4>
<ol type="1">
<li>Describe each function to each other in order - both what it does and which names you gave them and their variables.</li>
<li>The person(s) responsible for function five, describe how you added the three packages as dependencies and included the pipe in the package namespace.</li>
<li>Discuss why it is a good idea to limit the number of dependencies your package has. When can’t it be avoided?</li>
<li>Discuss the difference between adding an <code>@importFrom package function</code> tag to a function description compared to using <code>package::function()</code>. Read <a href="https://r-pkgs.org/namespace.html#imports">this section</a> if you are not sure or just want to learn more.</li>
</ol>
</section>
</section>
<section id="group-assignment" class="level3">
<h3 class="anchored" data-anchor-id="group-assignment"><span style="color: red;">GROUP ASSIGNMENT</span></h3>
<hr>
<p>For this week’s group assignment, write a vignette (user guide) for your package (<strong>max</strong> 2 pages). The vignette should include a brief description of what the package is about and demonstrate how each function in the package is used (individually and in conjunction with each other). As a final section, discuss use cases for the package and what other functions could be included. Also include the main points from your discussion in Task 3.</p>
<p>Include a link to your group’s GitHub repository at the top of the vignette. Hand it in as a pdf in DTU Learn, as you did the previous weeks.</p>
<ol type="1">
<li>Create a vignette with <code>usethis::use_vignette("package name")</code>.</li>
<li>When you are done writing it, run <code>devtools::build_vignettes()</code>.</li>
<li>At the top line of your vignette, change <code>rmarkdown::html_vignette</code> to <code>rmarkdown::pdf_document</code></li>
<li>Rerun <code>devtools::build_vignettes()</code> - the created pdf-file in the <code>doc</code>-folder is the document to hand it.</li>
<li>Lastly, duplicate the vignette as the GitHub README
<ul>
<li>Create a README with <code>usethis::use_readme_rmd( open = TRUE )</code>.</li>
<li>Copy the content of the vignette Rmarkdown into the readme <strong>Keep the top part of the README as is</strong>. If you overwrote it anyway, change <code>rmarkdown::pdf_document</code> to <code>rmarkdown::github_document</code>.</li>
<li>Run <code>devtools::build_readme()</code></li>
<li>Push the changes to GitHub</li>
</ul></li>
</ol>
</section>
<section id="last-tip-on-packages" class="level3">
<h3 class="anchored" data-anchor-id="last-tip-on-packages">Last tip on packages</h3>
<hr>
<p>Next week, I will introduce the <code>golem</code> package for building <a href="https://engineering-shiny.org/index.html">production-grade Shiny apps</a>. However, I personally also use it to quickly get going with packages.</p>
<p>When starting out with an R package, it may seem complicated with a lot of things to remember. <code>golem</code> remembers these things for you. When setting up your package / Shiny app with <code>golem::create_golem("Your awesome package/app name")</code>, it creates a <code>dev</code> folder with a few files listing all you need to get started with an R package.</p>
<p>It does also give you a lot of other things that you will rarely use, and it also sets up some basic structures for Shiny apps. These can simply be deleted if you are not also building a Shiny app.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./lab07.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Lab 7: Collaborative Bio Data Science using GitHub via RStudio</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./lab09.html" class="pagination-link">
        <span class="nav-page-text">Lab 9 Creating a Simple Shiny Application</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">R for Bio Data Science</div>   
    <div class="nav-footer-right">Full course description available at <a href="https://kurser.dtu.dk/course/22100">DTU Course Base</a>.</div>
  </div>
</footer>



</body></html>